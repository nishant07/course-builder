{% extends 'base.html' %}

{% block subtitle %}
{% trans %} Customize {% endtrans %}
{% endblock subtitle %}

{% block header_content %}
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
<script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
<script>
//    $(function() {
//        $( "#gcb-nav-y" ).accordion();
//
//        $( "#gcb-nav-y table tbody tr" ).draggable({
//            appendTo: "body",
//            helper: "clone"
//        });
//
//        $( "#droppedItems tbody" ).droppable({
//            activeClass:"ui-state-default",
//            hoverClass:"ui-state-hover",
//            accept:":not(.ui-sortable-helper)",
//            drop:function (event, ui) {
//                //alert(ui.helper.find('a'));
//                var td2 = document.createElement('td');
//                var tr = document.createElement('tr');
//                tr.appendChild(ui.helper.find('td'));
//                //tr.appendChild(td2);
//                $( "#droppedItems tbody" ).append(tr);
//                return true;
//            }
//        }).sortable({
//            items: "li:not(.placeholder)",
//            sort: function() {
//                // gets added unintentionally by droppable interacting with sortable
//                // using connectWithSortable fixes this, but doesn't allow you to customize active/hoverClass options
//                $( this ).removeClass( "ui-state-default" );
//            }});
//    });


$(document).ready(function(){
    $( "#gcb-nav-y" ).accordion();

    //this will hold reference to the tr we have dragged and its helper
    var c = {};

    $("#gcb-nav-y tr").draggable({
        appendTo: "body",
        helper: "clone",
        start: function(event, ui) {
            c.tr = this;
            c.helper = ui.helper;
        }
    });


    $("#droppedItems tbody").droppable({
            activeClass:"ui-state-default",
            hoverClass:"ui-state-hover",
            accept:":not(.ui-sortable-helper)",
        drop: function(event, ui) {
            var a = ui.draggable.find('a').text();
            var href = ui.draggable.find('a').attr('href');

            var an = document.createElement('a');
            an.setAttribute('href', href);
            an.innerHTML = a;

            var td = document.createElement('td');
            td.appendChild(an);

            var tr = document.createElement('tr');
            tr.appendChild(td);


            $( "#droppedItems tbody" ).append(tr);
            //$(this).find("input").val(inventor);

            $(c.tr).remove();
            $(c.helper).remove();
        }
    });
});

</script>
{% endblock %}

{% block top_content %}
{% endblock %}

{% block main_content %}

<div class="gcb-main">
    <div>
        <h3 class="class_header">
            Customize the lesson order
        </h3>
    </div>

    <div style="width: 25%;" class="gcb-nav" id="gcb-nav-y">
        {% for unit in units %}
        {% if unit.type != 'A' and unit.type != 'O' %}
            <h3>{{ unit.unit_id }}. {{ unit.title }}</h3>
            <div>
            {% if units_lessons[unit.unit_id] != 'None' %}
                <table>
                    <tbody>
                    {% for v in units_lessons[unit.unit_id] %}
                    <tr><td><a href="#">{{ unit.unit_id }}.{{v.lesson_id}}. {{v.title}}</a></td></tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% endif %}
            </div>
        {% endif %}
        {% endfor %}
    </div>

    <div class="gcb-article tab-content" style="width: 70%;" role="main">
        <div >
            <div class="ui-widget-content" id="droppedItems">
                <form method="post">
                    <table>
                        <thead>
                            <tr style="width: 100%"><td>Drop lessons</td></tr>
                        </thead>

                        <tbody>
                            <tr><td>Drop items here</td></tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}