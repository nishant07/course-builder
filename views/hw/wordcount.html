<div id="accordion">
    <h2>Overview</h2>
    <div>
        <p>WordCount is a simple program which counts the number of occurrences of each word in a
            given text input dataset.
            WordCount fits very well with the map/reduce programming model, making it a perfect
            example for illustrating
            the Hadoop MapReduce programming style. Our implementation consists of three main
            parts: </p>
        <ol>
            <li>Mapper</li>
            <li>Reducer</li>
            <li>Main program</li>
        </ol>
    </div>
    <h2>Write a Mapper</h2>
    <div>
        <p>A Mapper overrides the “map” function from the Class "org.apache.hadoop.mapreduce.Mapper"
            which provides &lt;key,
            value&gt; pairs as the input. A Mapper implementation may output &lt;key,value&gt; pairs
            using the provided
            Context. </p>

        <p>Input value of the WordCount Map task will be a line of text from the input data file and
            the key would be
            the line number &lt;line_number, line_of_text&gt; . Map task outputs &lt;word, one&gt;
            for each word in the
            line of text.
        </p>
        <p><u>Pseudo-code</u></p>
        <div class="dp-highlighter">
            <div class="bar">
                <div class="tools"></div>
            </div>
            <ol class="dp-j">
                <li class="alt"><span><span class="keyword">void</span><span>&nbsp;Map&nbsp;(key,&nbsp;value){&nbsp;&nbsp;</span></span>
                </li>
                <li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
                        class="keyword">for</span><span>&nbsp;each&nbsp;word&nbsp;x&nbsp;in&nbsp;value:&nbsp;&nbsp;</span></span>
                </li>
                <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.collect(x,&nbsp;<span
                        class="number">1</span><span>);&nbsp;&nbsp;</span></span></li>
                <li class=""><span>}&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
            </ol>
        </div>
        <!--<p><u>Detail implementation</u></p>-->
        <div>
            <script src="https://gist.github.com/cloudmooc/6232204.js"></script>
        </div>
    </div>
    <h2>Write a Reducer</h2>
    <div>
        <p>A Reducer collects the intermediate &lt;key,value&gt; output from multiple map tasks and
            assembles a single
            result. Here, the WordCount program will sum up the occurrence of each word into pairs
            as &lt;word, occurrence&gt;.
        </p>
        <p>
            <u>Pseudo-code</u>
        </p>

        <div class="dp-highlighter">
            <div class="bar">
                <div class="tools"></div>
            </div>
            <ol class="dp-j">
                <li class="alt"><span><span class="keyword">void</span><span>&nbsp;Reduce&nbsp;(keyword,&nbsp;&lt;list&nbsp;of&nbsp;value&gt;){&nbsp;&nbsp;</span></span>
                </li>
                <li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
                        class="keyword">for</span><span>&nbsp;each&nbsp;x&nbsp;in&nbsp;&lt;list&nbsp;of&nbsp;value&gt;:&nbsp;&nbsp;</span></span>
                </li>
                <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum+=x;&nbsp;&nbsp;</span>
                </li>
                <li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final_output.collect(keyword,&nbsp;sum);&nbsp;&nbsp;</span>
                </li>
                <li class="alt"><span>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
            </ol>
        </div>
        <pre name="code" class="java" style="display: none;">void&nbsp;Reduce&nbsp;(keyword,&nbsp;&lt;list&nbsp;of&nbsp;value&gt;){<br>    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;each&nbsp;x&nbsp;in&nbsp;&lt;list&nbsp;of&nbsp;value&gt;:<br>    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum+=x;<br>    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final_output.collect(keyword,&nbsp;sum);<br>}   </pre>
        <!--<p><u>Detail implementation</u></p>-->
        <div>
        <script src="https://gist.github.com/cloudmooc/6232383.js"></script>
        </div>
    </div>
    <h2>Set up the Main Program</h2>

    <div>

        <p>
            The Main program configures and runs the MapReduce job. We use the main program to
            perform basic
            configurations, such as:</p>
        <ol>
            <li><strong>Job Name</strong>: name of this Job</li>
            <li><strong>Executable (Jar) Class</strong>: the main executable class. For here,
                WordCount.
            </li>
            <li><strong>Mapper Class</strong>: class which overrides the "map" function. For here,
                Map.
            </li>

            <li><strong>Reducer</strong>: class which overrides the "reduce" function. For here,
                Reduce.
            </li>
            <li><strong>Output Key</strong>: type of output key. For here, Text.</li>
            <li><strong>Output Value</strong>: type of output value. For here, IntWritable.</li>
            <li><strong>File Input Path</strong></li>

            <li><strong>File Output Path</strong></li>
        </ol>
        <div>
        <script src="https://gist.github.com/cloudmooc/6232408.js"></script>
        </div>
    </div>
    <h2>Compile the Program</h2>
        <pre xml:space="preserve">cd ~/HadoopWordCount<br>./build.sh</pre>
    </div>
    <!-- content area -->
    <h2>Execute Standalone Hadoop-WordCount</h2>

    <div>
        <p>This section details the simplest way to run a standalone WordCount. First a <a
                href="http://salsahpc.indiana.edu/tutorial/apps/hadoop-0.20.2-standalone.tar.gz">standalone
            version of
            Hadoop</a> (without any environment setting) is required. You can find the program in
            the location &quot;~/HadoopWordCount&quot;. </p>

        <p>Assume that:</p>
        <ol>
            <li>~/software/hadoop-1.1.2 - Hadoop standalone framework directory</li>
        </ol>
        <p>Next, enter the following commands to run the program:</p>
<pre xml:space="preserve">
cd ~/software/hadoop-1.1.2/bin<br />
cp ~/HadoopWordCount/wordcount.jar ~/software/hadoop-1.1.2/bin<br />
# Make sure you copy the wordcount.jar in ~/software/hadoop-1.1.2/bin<br />
./hadoop jar wordcount.jar WordCount ~/HadoopWordCount/input ~/HadoopWordCount/output <br />
cd ~/HadoopWordCount/<br />
cat output/part-r-00000<br />
</pre>
    </div>
    <h2>Adding a Combiner</h2>

    <div>
        <p>A combiner is a reduce-type function to be used when there are map key-value pairs that
            are not immediately
            written to the output. It will collect those pairs in lists and perform local
            aggregation of the
            intermediate outputs. It speeds up the process, which cuts down the amount of data
            transferred from the
            Mapper to the Reducer.</p>
        <pre name="code"
             class="java">public static void main(String[] args) throws Exception {<br/>           // ....<br/>            // uncomment this line<br/>            job.setCombinerClass(Reduce.class);<br/>            // ....<br/>}</pre>

<pre xml:space="preserve">
cd ~/HadoopWordCount/<br />
./clean.sh <br />
ls  <br />
# you should have only build.sh clean.sh input & WordCount.java<br />
vi WordCount.java # uncomment the above line (line number 67) & save (ESC, :wq!)<br />
./build.sh<br />cd ~/software/hadoop-1.1.2/bin <br />cp ~/HadoopWordCount/wordcount.jar ~/software/hadoop-1.1.2/bin<br /><br /># Run the WordCount Program<br />./hadoop jar wordcount.jar WordCount ~/HadoopWordCount/input ~/HadoopWordCount/output-combiner<br /></pre>
    </div>
    <h2>Check the Result and Submit</h2>

    <div>
<pre xml:space="preserve">    
# Check the result<br/>
cd ~/HadoopWordCount/<br/>
cat output-combiner/part-r-00000</pre>
        <p> To submit, answer the following question: What are the Top 10 words to appear in the
            complete works of
            William Shakespeare? http://www.gutenberg.org/cache/epub/100/pg100.txt </p>
    </div>
    <div></div>
</div>
